# ADR-001: Единый формат ошибок RFC 7807

Дата: 2025-09-22
Статус: Accepted

## Context
В настоящее время ошибки в API возвращаются в разном формате, что усложняет обработку на стороне клиента. Необходимо стандартизировать формат ошибок для улучшения опыта разработки и отладки.

## Decision
Все ошибки API должны возвращаться в формате RFC 7807 (Problem Details for HTTP APIs) с обязательными полями:
- `type` (URI идентификатор типа ошибки)
- `title` (краткое описание)
- `status` (HTTP статус код)
- `detail` (детальное описание для пользователя)
- `instance` (URI конкретного запроса)
- `correlation_id` (идентификатор для трассировки)

Дополнительно, в целях безопасности, детали ошибок должны маскироваться в продакшене.

## Consequences
**Плюсы:**
- Стандартизация формата ошибок
- Улучшение опыта отладки благодаря correlation_id
- Соответствие лучшим практикам HTTP API

**Минусы:**
- Необходимость обновления всех обработчиков ошибок
- Дополнительные накладные расходы на генерацию correlation_id

## Links
- NFR-02 (Ошибки в формате RFC7807)
- R3 (Утечка PII), R7 (Отсутствие аудита операций)
- tests/test_errors.py::test_rfc7807_format
